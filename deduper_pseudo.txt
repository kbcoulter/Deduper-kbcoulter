##################################
### DeDuper Pseudocode Outline ###
##################################

#################
### FUNCTIONS ###
#################

Collect inputs using argparse...

Function: fivepstart: accepts POS (Integer), CIGAR (String), and FLAG (Integer) as arguments and returns an Integer.
    This function accepts the leftmost position, the cigar string, and the strandedness variable and returns the 5' start position of the read as an integer. 
    ** EXAMPLE INPUT AND OUTPUT BELOW **
    Return fivepstart(Integer)

INPUTS: 0,	130171693,	71M	*
OUTPUT: 130171693

Function: umigrabber: accepts QNAME string input and returns an UMI string.
    This function accepts the Query Template Name, and cuts the template down to return only the UMI as a string.
    ** EXAMPLE INPUT AND OUTPUT BELOW **
    Return UMI(Intiger)

INPUT: NS500451:154:HWKTMBGXX:1:11101:6251:1098:GTTACGTA
OUTPUT: GTTACGTA

###################
### SCRIPT BODY ###
###################

Read the possible UMIs into set called UMISET
Create a BADUMI Dictionary 
Create a DUPLICATE Dictionary 
Open an output file for writing at the provided path

Open the input SAM file for reading:

    Set refer_pos equal to None
    Set refer_umi equal to None
    Set refer_flag equal to None
    Set refer_rname equal to None
    Set reference equal to None

    For each line in the file:
        If line begins with @:
            Write the line to the output file
            Continue

        Set umi equal to umigrabber (Line TEMPLATE NAME)
        If umi not in UMISET:
            Update BADUMI
            continue

        Write the line to the output file.                                       # REFERENCE FOUND #
        # OPTIONAL: Count references for chromosomes ID # 
        Set reference equal to the current line 
        Set refer_flag equal to reference FLAG
        Set refer_pos equal to fivepstart(reference POS, CIGAR, FLAG)
        Set refer_umi equal to umi
        Set refer_rname equal to reference RNAME
        Break
    
    For query following the reference: # Loop Continues From Same Spot
        Set query_umi equal to umigrabber(query TEMPLATE NAME)
        If query_umi not in UMISET:
            Update BADUMI
            continue

        Set query_rname equal to Query RNAME

        If query_rname is not the same as refer_rname: ### CHROMOSOMES DO NOT MATCH ###
            Write reference to the output file.
            Set reference equal to query
            Set refer_flag equal to query_flag
            Set refer_pos equal to query_pos
            Set refer_umi equal query_umi
            Set refer_rname equal to query_rname
            continue

        query_flag = Query FLAG
            
        if refer_flag is the same as query_flag:                                # STRAND MATCH
            if query_umi is the same as ref_umi:                                # UMI MATCH
                Set query_pos equal to fivepstart(query POS, CIGAR, FLAG)
                if query_pos is the same as refer_pos:                          # POSITION MATCH
                    Update DUPLICATE Dictionary                                 # DUPLICATE FOUND
                    Continue
                else: write query to output
            else: write query to output
        else: write query to output
        
        Set reference equal to query
        Set refer_flag equal to query_flag
        Set refer_pos equal to fivepstart(query POS, CIGAR, query_flag) # CONDITIONAL
        Set refer_umi equal to query_umi
        Set refer_rname equal to query_rname

write last reference to output file
close output file

##############
### OUTPUT ###
##############

Within the same directory as the output file, open to write .txt report 
    Write Duplicate Dictionary, Bad UMI Dictionary, Possibly UMI Bank, Possibly Paths into .txt and close. 

### OPTIONAL: Print "Done DeDuplicating!"

#######################
### FUNCTION TESTING ###
########################

if __name__ is equal to main:

    (Run tests for the functions with assert.)

    umigrabber:
        INPUT: NS500451:154:HWKTMBGXX:1:11101:6251:1098:GTTACGTA
        OUTPUT: GTTACGTA

    fivepstart:
        INPUTS: 0,	130171693,	71M	*
        OUTPUT: 130171693




